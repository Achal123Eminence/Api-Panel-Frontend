<div class="cricket-container">
  <h1 class="main-heading">{{ sportId === '4' ? 'Cricket' : sportId === '1' ? 'Soccer' : sportId === '2' ? 'Tennis' : '' }} Markets</h1>

  <!-- Search & Page Size -->
  <div class="table-responsive" style="box-shadow: #000 0 2px 6px;">
    <div class="d-flex justify-content-between align-items-center p-2"
      style="background-color: #006e76;border-bottom: 1px solid #fff;">
      <div>
        <label class="me-2">Show</label>
        <select class="form-select d-inline-block w-auto" (change)="setPageSize($event)">
          <option value="5">5</option>
          <option value="10" selected>10</option>
          <option value="25">25</option>
          <option value="50">50</option>
        </select>
        <label class="ms-2">entries</label>
      </div>
      <div>
        <input type="text" class="form-control" placeholder="Search..." style="max-width: 250px;" [value]="searchTerm()"
          (input)="onSearchChange($event)" />
      </div>
    </div>

    <!-- Table -->
    <table class="table table-striped mb-0">
      <thead>
        <tr>
          <th scope="col">Sr.No</th>
          <th scope="col">Event Id / Event Name</th>
          <th scope="col">Market Name</th>
          <th scope="col">Market Id</th>
          <th scope="col">Action</th>
        </tr>
      </thead>
      <tbody>
        @for (item of paginatedList(); track $index) {
        <tr>
          <td scope="row">{{ ($index + 1) + ((currentPage()-1) * pageSize()) }}</td>
          <td>{{item.event.id}} / {{item.event.name}} </td>
          <td>{{item.marketName}}</td>
          <td>{{item.marketId}}</td>
          <td>
            <button class="events-btn" (click)="openMarketDataModal(item.marketId)">Add</button>
          </td>
        </tr>
        }
      </tbody>
    </table>

    <!-- Pagination -->
    <div class="d-flex justify-content-between align-items-center p-2" style="background-color: #006e76;">
      <div class="entries-num">
        Showing <strong>{{ (currentPage()-1) * pageSize() + 1 }}</strong> to <strong>{{ Math.min(currentPage() * pageSize(), filteredList().length) }}</strong> of <strong>{{ filteredList().length }}</strong> entries
      </div>
      <nav>
        <ul class="pagination pagination-sm mb-0">
          <li class="page-item" [class.disabled]="currentPage() === 1">
            <a class="page-link" (click)="setPage(currentPage()-1)">Previous</a>
          </li>
          @for (page of [].constructor(totalPages()); track $index) {
            <li class="page-item" [class.active]="currentPage() === ($index+1)">
              <a class="page-link" (click)="setPage($index+1)">{{ $index+1 }}</a>
            </li>
          }
          <li class="page-item" [class.disabled]="currentPage() === totalPages()">
            <a class="page-link" (click)="setPage(currentPage()+1)">Next</a>
          </li>
        </ul>
      </nav>
    </div>
  </div>
</div>

<!-- Market Data Modal -->
<div class="modal fade" id="marketDataModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-top">
    <div class="modal-content" style="background: #006e76; color: white;">
      <div class="modal-header border-0" style="border-bottom: 1px solid #144b4f !important;">
        <h5 class="modal-title" style="font-size: 1rem;">Market Data</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body" style="background-color: #fff; color: #000;">
        <!-- JSON Display -->
        <pre
          style="background:#f8f9fa; color:#212529; padding:10px; border-radius:8px; max-height:300px; overflow:auto; font-size:0.9rem;">{{ cricketMarketBookList() | json }}</pre>
      </div>

      <div class="modal-footer border-0">
        <button class="btn btn-light" (click)="copyJson()">
          <i class="fa fa-clipboard"></i> Copy JSON
        </button>
      </div>
    </div>
  </div>
</div>

<div class="loader-overlay" *ngIf="isloading">
  <div class="spinner"></div>
</div>